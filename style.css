function doPost(e) {
  try {
    // ID del tuo foglio Google
    var ss = SpreadsheetApp.openById("1akBwIBwIbWBLZD9h0AAauOA-esp058cyysoP8iP72sw");
    var sheet = ss.getSheetByName("Foglio1");

    var data = e.parameter;
    Logger.log(JSON.stringify(data));

    // Inserisci i dati nel foglio
    sheet.appendRow([
      data.Nome || "",
      data.Cognome || "",
      data.Anno || "",
      data.Telefono || "",
      data.Instagram || "",
      new Date()
    ]);

    return ContentService
      .createTextOutput("✅ Successo! Dati inseriti.")
      .setMimeType(ContentService.MimeType.TEXT);

  } catch (error) {
    Logger.log("Errore: " + error.message);
    return ContentService
      .createTextOutput("❌ Errore: " + error.message)
      .setMimeType(ContentService.MimeType.TEXT);
  }
}
